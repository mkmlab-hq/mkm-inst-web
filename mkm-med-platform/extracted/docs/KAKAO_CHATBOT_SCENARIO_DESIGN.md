# 🤖 카카오 i 오픈빌더 사전 문진 시나리오 설계

## 📋 프로젝트 개요
- **과제**: [TASK-CB-001] 카카오 i 오픈빌더 사전 문진 시나리오 설계
- **목표**: 노인 친화적 하이터치 전략 기반 문진 챗봇 완성
- **대상**: 병원 방문 환자 (특히 노인층)
- **플랫폼**: 카카오 i 오픈빌더 (시각적 시나리오 편집기)

---

## 🎯 핵심 설계 원칙

### 1. 하이터치 전략
- **직원 도움**: 모든 단계에서 직원 도움 요청 가능
- **큰 버튼**: 터치하기 쉬운 대형 버튼
- **명확한 안내**: 단순하고 직관적인 문구

### 2. 사용자 경험 최적화
- **단계별 진행**: 한 번에 하나씩 질문
- **시각적 안내**: 이모지와 아이콘 활용
- **확인 과정**: 입력 내용 재확인 단계

### 3. 기술 연동
- **웹훅 API**: 기존 구현된 `/api/v1/kakao/webhook` 연결
- **Firestore 저장**: 문진 데이터 자동 저장
- **브리핑 연동**: 문진 완료 시 원장 브리핑 자동 생성

---

## 🏗️ 시나리오 전체 구조

```
┌─────────────────────────────────────────────────────────────────┐
│                    MKM Lab 문진 챗봇 시나리오                    │
└─────────────────────────────────────────────────────────────────┘

[Block 1] 환영 인사 & 개인정보 동의
    ↓
[Block 2] 기본 정보 수집 (이름, 나이)
    ↓
[Block 3] 주요 증상 선택 (5가지 옵션)
    ↓
[Block 4] 증상 상세 입력
    ↓
[Block 5] 추가 정보 입력 (선택사항)
    ↓
[Block 6] 입력 내용 확인
    ↓
[Block 7] 문진 완료 & 접수 안내
    ↓
[Block 8] 웹훅 API 호출 (백엔드 연동)

[Support Block] 직원 도움 요청 (모든 단계에서 접근 가능)
[Support Block] 오류 처리 및 재시도
```

---

## 🎬 Block 1: 환영 인사 & 개인정보 동의

### 블록 설정
- **블록 이름**: `welcome_and_consent`
- **블록 유형**: 텍스트 + 버튼
- **다음 블록 연결**: `basic_info_collection`

### 시나리오 스크립트

#### 📝 메인 메시지
```
🏥 안녕하세요! MKM Lab입니다.

진료를 위한 간단한 사전 문진을 도와드리겠습니다.

직원이 옆에서 언제든 도와드릴 수 있으니 
편안하게 진행해 주세요.

📋 개인정보 수집 및 이용 동의

• 수집 목적: 진료 및 문진 서비스 제공
• 수집 항목: 이름, 나이, 증상 정보
• 보관 기간: 진료 완료 후 1년
• 제3자 제공: 담당 의료진에게만 제공

개인정보 수집 및 이용에 동의하시겠습니까?
```

#### 🔘 버튼 옵션
1. **동의합니다** → `basic_info_collection` 블록으로 이동
2. **🙋‍♀️ 직원 도움 요청** → `staff_help` 블록으로 이동
3. **더 자세히 알고 싶어요** → `privacy_details` 블록으로 이동

### 카드 메시지 구조
```json
{
  "version": "2.0",
  "template": {
    "outputs": [
      {
        "basicCard": {
          "title": "🏥 MKM Lab 문진 시작",
          "description": "진료를 위한 간단한 사전 문진을 도와드리겠습니다.\n\n직원이 옆에서 언제든 도와드릴 수 있으니 편안하게 진행해 주세요.",
          "thumbnail": {
            "imageUrl": "https://your-domain.com/images/mkmlogo-card.png",
            "fixedRatio": true
          },
          "buttons": [
            {
              "action": "block",
              "label": "✅ 문진 시작하기",
              "blockId": "consent_detail"
            }
          ]
        }
      }
    ]
  }
}
```

---

## 🎨 시각적 블록 구조도

```
┌─────────────────────────────────────────────┐
│            [Block 1] 환영 인사               │
│  ┌─────────────────────────────────────────┐ │
│  │  🏥 안녕하세요! MKM Lab입니다.         │ │
│  │                                         │ │
│  │  진료를 위한 간단한 사전 문진을         │ │
│  │  도와드리겠습니다.                      │ │
│  │                                         │ │
│  │  직원이 옆에서 언제든 도와드릴 수       │ │
│  │  있으니 편안하게 진행해 주세요.         │ │
│  └─────────────────────────────────────────┘ │
│                                             │
│  ┌─────────────────┐  ┌─────────────────┐  │
│  │  ✅ 동의합니다  │  │🙋‍♀️ 직원 도움 │  │
│  │      (다음)     │  │   요청 (도움)   │  │
│  └─────────────────┘  └─────────────────┘  │
│                                             │
│  ┌─────────────────────────────────────────┐ │
│  │     📋 더 자세히 알고 싶어요            │ │
│  │          (개인정보 상세)                │ │
│  └─────────────────────────────────────────┘ │
└─────────────────────────────────────────────┘
             ↓ (동의 시)
┌─────────────────────────────────────────────┐
│          [Block 2] 기본 정보 수집           │
│                   (다음 설계)               │
└─────────────────────────────────────────────┘
```

---

## 🛠️ 구현 체크리스트

### Phase 1: 환영 블록 완성
- [ ] 카카오 i 오픈빌더 프로젝트 생성
- [ ] 환영 인사 블록 생성
- [ ] 개인정보 동의 텍스트 작성
- [ ] 버튼 액션 설정
- [ ] 브랜딩 이미지 적용

### Phase 2: 연결 블록 준비
- [ ] 직원 도움 요청 블록 생성
- [ ] 개인정보 상세 설명 블록 생성
- [ ] 기본 정보 수집 블록 설계

### Phase 3: 테스트 및 최적화
- [ ] 시나리오 흐름 테스트
- [ ] 사용자 경험 최적화
- [ ] 웹훅 API 연동 테스트

---

## 🎯 다음 단계 미리보기

### Block 2: 기본 정보 수집
- **이름 입력**: "성함을 알려주세요"
- **나이 입력**: "연세를 알려주세요" (버튼 형태: 20대, 30대, 40대, 50대, 60대, 70대 이상)

### Block 3: 주요 증상 선택
```
💭 오늘 가장 불편하신 증상을 선택해주세요

① 허리/어깨/무릎 통증
② 삐끗/멍/타박상  
③ 소화불량/속쓰림
④ 두통/어지럼증
⑤ 피로/스트레스
```

---

## 🚀 즉시 실행 계획

1. **환영 블록 완성** (30분)
2. **기본 정보 수집 블록** (20분)
3. **주요 증상 선택 블록** (30분)
4. **전체 시나리오 연결** (20분)

**총 예상 소요 시간: 1시간 40분**

---

**🎬 준비 완료!** 환영 인사 블록 설계가 완료되었습니다. 이제 카카오 i 오픈빌더에서 실제 구현을 시작하겠습니다.
