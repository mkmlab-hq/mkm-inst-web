# MKM Lab 프로젝트 컨텍스트 브리핑 (v6.0)

**문서 ID:** CONTEXT-BRIEFING-006  
**최종 업데이트:** 2025-07-08  
**작성자:** MKM Lab AI Development Team  
**문서 유형:** 프로젝트 마스터 가이드 (Single Source of Truth)  
**버전:** v6.0

---

## 📋 **핵심 워크플로우: '작전 브리핑 시스템'**

### **원칙**: '선(先)계획, 후(後)실행'
- 새로운 기능 개발 착수 전, 목표와 명세가 담긴 '작전 브리핑'을 먼저 작성
- 대표님의 최종 승인을 받은 후에만 코드 제안 시작
- 승인 없이는 코드 제안을 시작하지 않음

---

## 🏗️ **기술 스택 및 아키텍처**

### **플랫폼**
- **브랜드**: 'Molly AI' 단일 브랜드의 반응형 웹 플랫폼 (PC/모바일)

### **아키텍처**
- **구조**: '단일 진입점, 이중 모드'
  - 기본: 환자용 (B2C)
  - 특정 로그인: 전문가용 (B2B)

### **기술 스택**
- **프론트엔드**: Vue.js 3 + Vite
- **백엔드/인프라**: Firebase (Firestore, Authentication, Hosting, Functions)
- **개발 환경**: Cursor.ai (주), GitHub Codespaces (비상용)
- **AI/외부연동**: Vertex AI (Gemini, Vector Search), KakaoTalk API

---

## 🎯 **핵심 전략 및 정책**

### **B2C 사용자 획득 모델 (직선형 온보딩)**

#### **1단계: 진입**
- 한의원 대기실에서 QR코드로 전용 페이지(`/clinic`)에 접속

#### **2단계: 인증**
- '카카오톡으로 시작하기' 버튼으로 간편 가입/로그인

#### **3단계: 검사**
- '설문 → 설진 → 음성' 순서의 고정된 흐름으로 검사 완료

### **B2C 지속적 관계 관리 모델**

#### **재방문**
- 일반 주소(`/`)로 접속 시, '나의 건강 현황' 대시보드 표시

#### **기능**
- 대시보드에서 과거/최신 분석 결과 확인
- 원할 때 언제든 **재검사 시작**
- 한의사가 보낸 **'최종 솔루션' 확인**
- 맞춤형 건강 정보 수신

### **'전문가 솔루션' 카톡 전송**
- 한의사가 대시보드에서 작성한 최종 솔루션을 환자의 카카오톡으로 전송
- **의료법 준수** 필수

### **지식 라이브러리**
- 논문 등 전문 자료를 벡터화하여 'Vertex AI Vector Search'에 저장
- Molly AI의 독자적인 지식 기반으로 활용

---

## ⚙️ **주요 기능 명세**

### **로그인 시스템**
- **하이브리드 방식**
  - 전문가: 이메일/비밀번호
  - 일반사용자: 카카오톡

### **음성 분석 (2-Track 시스템)**

#### **Track 1 (기본)**
- "아~" 모음을 **3초**간 녹음
- 안정성/피로도 등 기본 지표 확인

#### **Track 2 (심화)**
- 전문가가 선택적으로 활성화하는 치료용 기능
- 지터/쉼머 등 상세 값 분석
- 맞춤 훈련 프로그램 제공

---

## ⚖️ **법적 준수 사항 (솔루션 전송 시)**

### **내용 명확화**
- '대면 진료 결과 기반'임을 명시

### **'진단' 용어 회피**
- '치료 계획', '생활 가이드' 등 정보 전달에 집중

### **사전 동의**
- 카카오톡 정보 수신에 대한 환자의 사전 동의 확보

---

## 📊 **현재 상태 및 다음 임무**

### **현재 상태**
- ✅ Firebase Blaze 플랜 업그레이드 완료
- ✅ Vue.js 3 + Vite 프론트엔드 구축 완료
- ✅ Firebase 인증 및 Firestore 연동 완료
- ✅ 설진/음성검사 UI 컴포넌트 구현 완료
- ✅ 카카오톡/구글 로그인 연동 완료
- ✅ docs 폴더 인코딩 복원 완료 (99% 성공률)

### **다음 임무**
**'카카오 로그인'을 위한 커스텀 토큰 생성 API를 **Firebase Functions**에 배포하고, 프론트엔드와 최종 연동하여 '직선형 온보딩'의 첫 단계인 카카오 로그인을 완성한다.**

---

## 📋 **프로젝트 구조**

### **레이아웃 시스템**
- **ExpertLayout**: 전문가용 (사이드바 포함)
- **PatientLayout**: 환자용 (하단 탭바 포함)
- **DefaultLayout**: 공용 (로그인 등)

### **라우팅 구조**
- **공용**: `/login`, `/auth/kakao/callback`
- **전문가용**: `/pro/dashboard`, `/pro/users`, `/pro/reports` 등
- **환자용**: `/`, `/analysis`, `/tongue-analysis`, `/voice-analysis` 등

### **인증 시스템**
- **전문가용**: 로그인 필수 (`requiresAuth: true`)
- **환자용**: 인증 없이 접근 가능
- **네비게이션 가드**: 인증 상태에 따른 자동 리다이렉트

---

## 🔧 **개발 환경 설정**

### **로컬 개발**
```bash
# 프론트엔드 서버 시작
npm run dev

# Firebase Functions 배포
firebase deploy --only functions

# 전체 배포
npm run build && firebase deploy
```

### **환경변수**
- `.env` 파일에 API 키들 관리
- Firebase Functions 환경변수 설정
- 카카오톡 리다이렉트 URI 등록

---

## 📚 **문서화 정책**

### **필수 문서**
- 모든 변경사항은 즉시 문서화
- 코드 주석 및 테스트 파일 정리
- 이슈 발생 시 전체 로그 공유

### **버전 관리**
- 모든 문서에 버전 번호 명시
- 변경 이력 추적
- 마스터 인덱스 유지

---

## 🎯 **성공 지표**

### **기술적 지표**
- Firebase Functions 배포 성공률 100%
- 카카오 로그인 연동 성공률 100%
- 프론트엔드 빌드 오류 0%

### **사용자 경험 지표**
- 직선형 온보딩 완료율
- 카카오톡 솔루션 전송 성공률
- 재방문율

---

## 📞 **담당자 정보**

- **기술 담당**: AI Development Team
- **문서 관리**: 2025-07-08
- **최종 버전**: v6.0

---

**문서 끝**  
**문서 유형**: 프로젝트 마스터 가이드  
**소스**: MKM Lab 프로젝트 컨텍스트 브리핑 v6.0 