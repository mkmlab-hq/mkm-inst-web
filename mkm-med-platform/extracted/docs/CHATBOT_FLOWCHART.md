# 📊 MKM Lab 문진 챗봇 전체 플로우차트

## 🎯 시나리오 전체 구조

```
                    ┌─────────────────────────────────────────┐
                    │             사용자 접속                 │
                    │        (카카오톡 채널 추가)             │
                    └─────────────────┬───────────────────────┘
                                      │
                    ┌─────────────────▼───────────────────────┐
                    │          [Block 1] 환영 인사            │
                    │     🏥 안녕하세요! MKM Lab입니다        │
                    │                                         │
                    │  ┌─────────────────────────────────────┐ │
                    │  │    📋 개인정보 동의 보기            │ │
                    │  └─────────────────────────────────────┘ │
                    └─────────────────┬───────────────────────┘
                                      │
                    ┌─────────────────▼───────────────────────┐
                    │        [Block 1-1] 개인정보 동의        │
                    │                                         │
                    │  ┌─────────────┐  ┌─────────────┐       │
                    │  │✅ 동의합니다│  │🙋‍♀️ 직원 도움│       │
                    │  └─────────────┘  └─────────────┘       │
                    │  ┌─────────────────────────────────────┐ │
                    │  │      ❓ 더 자세한 설명              │ │
                    │  └─────────────────────────────────────┘ │
                    └───────┬─────────────────────────────────┘
                            │ (동의 시)
                    ┌───────▼─────────────────────────────────┐
                    │        [Block 2] 기본 정보 수집         │
                    │                                         │
                    │  👤 먼저 성함을 알려주세요              │
                    │  ┌─────────────────────────────────────┐ │
                    │  │         [텍스트 입력]               │ │
                    │  └─────────────────────────────────────┘ │
                    │  ┌─────────────┐  ┌─────────────┐       │
                    │  │🎤 음성으로  │  │🙋‍♀️ 직원 도움│       │
                    │  │   말하기    │  │    요청     │       │
                    │  └─────────────┘  └─────────────┘       │
                    └───────┬─────────────────────────────────┘
                            │ (이름 입력 후)
                    ┌───────▼─────────────────────────────────┐
                    │       [Block 2-1] 연세 입력             │
                    │                                         │
                    │  🎂 연세를 알려주세요                   │
                    │  ┌─────┐ ┌─────┐ ┌─────┐ ┌─────┐       │
                    │  │20대 │ │30대 │ │40대 │ │50대 │       │
                    │  └─────┘ └─────┘ └─────┘ └─────┘       │
                    │  ┌─────┐ ┌─────┐ ┌─────────────┐       │
                    │  │60대 │ │70대+│ │🙋‍♀️ 직원 도움│       │
                    │  └─────┘ └─────┘ └─────────────┘       │
                    └───────┬─────────────────────────────────┘
                            │ (나이 선택 후)
                    ┌───────▼─────────────────────────────────┐
                    │        [Block 3] 주요 증상 선택         │
                    │                                         │
                    │  💭 가장 불편하신 증상을 선택해주세요    │
                    │  ┌─────────────────────────────────────┐ │
                    │  │      ① 허리/어깨/무릎 통증          │ │
                    │  └─────────────────────────────────────┘ │
                    │  ┌─────────────────────────────────────┐ │
                    │  │      ② 삐끗/멍/타박상               │ │
                    │  └─────────────────────────────────────┘ │
                    │  ┌─────────────────────────────────────┐ │
                    │  │      ③ 소화불량/속쓰림              │ │
                    │  └─────────────────────────────────────┘ │
                    │  ┌─────────────────────────────────────┐ │
                    │  │      ④ 두통/어지럼증               │ │
                    │  └─────────────────────────────────────┘ │
                    │  ┌─────────────────────────────────────┐ │
                    │  │      ⑤ 피로/스트레스               │ │
                    │  └─────────────────────────────────────┘ │
                    │  ┌─────────────┐  ┌─────────────┐       │
                    │  │⑥ 기타 증상 │  │🙋‍♀️ 직원 도움│       │
                    │  └─────────────┘  └─────────────┘       │
                    └───────┬─────────────────────────────────┘
                            │ (증상 선택 후)
                    ┌───────▼─────────────────────────────────┐
                    │       [Block 4] 증상 상세 입력          │
                    │                                         │
                    │  📝 선택하신 증상에 대해                │
                    │     더 자세히 알려주세요                │
                    │                                         │
                    │  • 언제부터 아프셨나요?                 │
                    │  • 어떤 상황에서 더 아픈가요?           │
                    │  • 통증의 정도는 어떤가요?              │
                    │                                         │
                    │  ┌─────────────────────────────────────┐ │
                    │  │         [텍스트 입력]               │ │
                    │  └─────────────────────────────────────┘ │
                    │  ┌─────────────┐  ┌─────────────┐       │
                    │  │🎤 음성으로  │  │🙋‍♀️ 직원 도움│       │
                    │  │   말하기    │  │    요청     │       │
                    │  └─────────────┘  └─────────────┘       │
                    └───────┬─────────────────────────────────┘
                            │ (상세 입력 후)
                    ┌───────▼─────────────────────────────────┐
                    │       [Block 5] 추가 정보 입력          │
                    │                (선택사항)               │
                    │                                         │
                    │  ➕ 추가로 알려주실 내용이 있으신가요?   │
                    │                                         │
                    │  • 복용 중인 약물                       │
                    │  • 과거 병력                           │
                    │  • 기타 증상                           │
                    │                                         │
                    │  ┌─────────────────────────────────────┐ │
                    │  │         [텍스트 입력]               │ │
                    │  └─────────────────────────────────────┘ │
                    │  ┌─────────────┐  ┌─────────────┐       │
                    │  │✅ 건너뛰기  │  │🙋‍♀️ 직원 도움│       │
                    │  └─────────────┘  └─────────────┘       │
                    └───────┬─────────────────────────────────┘
                            │ (입력 완료 후)
                    ┌───────▼─────────────────────────────────┐
                    │        [Block 6] 입력 내용 확인         │
                    │                                         │
                    │  ✅ 입력하신 내용을 확인해주세요        │
                    │                                         │
                    │  👤 성함: [입력된 이름]                 │
                    │  🎂 연세: [선택된 나이]                 │
                    │  💭 주요 증상: [선택된 증상]             │
                    │  📝 상세 내용: [입력된 상세 내용]        │
                    │  ➕ 추가 정보: [입력된 추가 정보]        │
                    │                                         │
                    │  ┌─────────────┐  ┌─────────────┐       │
                    │  │✅ 맞습니다  │  │✏️ 수정하기  │       │
                    │  └─────────────┘  └─────────────┘       │
                    │  ┌─────────────────────────────────────┐ │
                    │  │         🙋‍♀️ 직원 도움 요청         │ │
                    │  └─────────────────────────────────────┘ │
                    └───────┬─────────────────────────────────┘
                            │ (확인 완료 후)
                    ┌───────▼─────────────────────────────────┐
                    │       [Block 7] 문진 완료 안내          │
                    │                                         │
                    │  🎉 문진이 완료되었습니다!              │
                    │                                         │
                    │  📋 접수 정보                           │
                    │  • 접수 번호: [자동 생성]               │
                    │  • 접수 시간: [현재 시간]               │
                    │  • 대기 순서: [예상 순서]               │
                    │                                         │
                    │  원장님께 브리핑이 전달되었습니다.      │
                    │  잠시만 기다려주세요.                   │
                    │                                         │
                    │  ┌─────────────────────────────────────┐ │
                    │  │      📱 진료 대기 현황 보기         │ │
                    │  └─────────────────────────────────────┘ │
                    └───────┬─────────────────────────────────┘
                            │ (백그라운드 처리)
                    ┌───────▼─────────────────────────────────┐
                    │       [Block 8] 웹훅 API 호출           │
                    │          (백엔드 연동)                  │
                    │                                         │
                    │  🔄 처리 중...                          │
                    │                                         │
                    │  1. Firestore 데이터 저장               │
                    │  2. 원장 브리핑 생성                    │
                    │  3. 브리핑 발송                         │
                    │  4. 접수 번호 생성                      │
                    │                                         │
                    │  ┌─────────────────────────────────────┐ │
                    │  │    ✅ 처리 완료 알림 전송           │ │
                    │  └─────────────────────────────────────┘ │
                    └─────────────────────────────────────────┘


                    ┌─────────────────────────────────────────┐
                    │     [Support] 직원 도움 요청 블록       │
                    │                                         │
                    │  🙋‍♀️ 직원을 호출하고 있습니다...      │
                    │                                         │
                    │  잠시만 기다려주세요.                   │
                    │  직원이 곧 도와드리겠습니다.            │
                    │                                         │
                    │  ┌─────────────────────────────────────┐ │
                    │  │      🔄 대기 중...                  │ │
                    │  └─────────────────────────────────────┘ │
                    │  ┌─────────────────────────────────────┐ │
                    │  │      ↩️ 이전으로 돌아가기          │ │
                    │  └─────────────────────────────────────┘ │
                    └─────────────────────────────────────────┘
```

---

## 🎯 핵심 플로우 포인트

### 1. 하이터치 지원
- **모든 블록에서 직원 도움 요청 가능**
- 직원 호출 시 백그라운드 알림 시스템 작동
- 언제든 이전 단계로 돌아가기 가능

### 2. 사용자 편의성
- **큰 버튼**: 터치하기 쉬운 대형 버튼
- **명확한 안내**: 각 단계마다 구체적인 안내
- **선택과 입력**: 버튼 선택과 직접 입력 모두 지원

### 3. 데이터 흐름
```
사용자 입력 → 임시 저장 → 확인 단계 → 최종 저장 → 브리핑 생성 → 원장 전달
```

### 4. 오류 처리
- **네트워크 오류**: 재시도 버튼 제공
- **입력 오류**: 수정 기회 제공
- **시스템 오류**: 직원 도움 요청으로 안내

---

## 🚀 구현 우선순위

### Phase 1: 핵심 플로우 (1-3 블록)
1. **환영 인사 & 개인정보 동의**
2. **기본 정보 수집**
3. **주요 증상 선택**

### Phase 2: 상세 입력 (4-6 블록)
4. **증상 상세 입력**
5. **추가 정보 입력**
6. **입력 내용 확인**

### Phase 3: 완료 및 연동 (7-8 블록)
7. **문진 완료 안내**
8. **웹훅 API 호출**

### Phase 4: 지원 시스템
- **직원 도움 요청 블록**
- **오류 처리 블록**
- **개인정보 상세 설명 블록**

---

**📋 전체 플로우차트 완성!**

이제 각 블록을 단계별로 구현할 수 있는 명확한 로드맵이 준비되었습니다.
